<%= form_for @podcast_album, url: url_for(action: :update, controller: 'admins/podcast_albums', id: @podcast_album.id), remote: true, method: :patch do |form| %>
  <div class="modal-header">
    <h5 class="modal-title text_green">Update Podcast Album</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
  </div>
  <div class="modal-body">
    <div class="personal-image form-group">
      <label class="label">
        <%= form.file_field :image, class: "form-control", id: 'img-input' %>
        <figure class="personal-figure">
          <%= image_tag @podcast_album.image.url, alt: "Album Avatar", class: "personal-avatar", id: 'album_img' %>
          <figcaption class="personal-figcaption">
            <img src="https://raw.githubusercontent.com/ThiagoLuizNunes/angular-boilerplate/master/src/assets/imgs/camera-white.png">
          </figcaption>
        </figure>
      </label>
    </div>
    <div class="form-group">
      <%= form.label :name, class: 'form-label' %>
      <%= form.text_field :name, class: 'form-control' %>
    </div>
    <div class="form-group">
      <%= form.label :user_id, 'Select User', class: 'form-label' %>
      <%= form.select :user_id, User.all.map { |t| [t.user_name, t.id]}, {}, class: "form-select" %>
    </div>
  </div>
  <div class="modal-footer">
    <div class="form-group justify-content-center">
      <%= form.submit "Update Album", class: "btn btn-primary button_border bg_green border_green button_hover"%>
    </div>
  </div>
<% end %>

<style>
    .personal-image {
        text-align: center;
    }
    .personal-image input[type="file"] {
        display: none;
    }
    .personal-figure {
        position: relative;
        width: 120px;
        height: 120px;
    }
    .personal-avatar {
        cursor: pointer;
        width: 120px;
        height: 120px;
        box-sizing: border-box;
        border-radius: 100%;
        border: 2px solid transparent;
        box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.2);
        transition: all ease-in-out .3s;
    }
    .personal-avatar:hover {
        box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.5);
    }
    .personal-figcaption {
        cursor: pointer;
        position: absolute;
        top: 0px;
        width: inherit;
        height: inherit;
        border-radius: 100%;
        opacity: 0;
        background-color: rgba(0, 0, 0, 0);
        transition: all ease-in-out .3s;
    }
    .personal-figcaption:hover {
        opacity: 1;
        background-color: rgba(0, 0, 0, .5);
    }
    .personal-figcaption > img {
        margin-top: 32.5px;
        width: 50px;
        height: 50px;
    }
</style>
<script type="module">
    $(document).on('ready', function() {
        handle_preview($("#img-input"), $("#album_img"));
    });

    function readURL(input, image) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e) {
                image.attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    function handle_preview(input_tag, image){
        input_tag.change(function(e){
            var file = e.target.files[0];
            readURL(e.target, image);
        });
    }

</script>